<!DOCTYPE html>
<html id="html">

<head>
    <title>Ear Training</title>
    <style type="text/css">
        body {
            margin: 1.35em !important;
        }

        html {
            background-color: black;
        }

        h1, button, p {
            font-family: Verdana;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        h1, p {
            color: white;
        }

        p {
            display: inline;
        }

        .selected {
            background-color: greenyellow;
        }
    </style>
</head>

<body>
    <h1>Ear Training</h1>
    <button id="playNote" onclick="playNote()">Play Note</button>
    <button id="revealNote" onclick="revealNote()">Reveal Note</button>
    <p id="noteText"></p>
    <br>
    <div id="noteSelector">
        <button id="C" onclick="selectNote(0)">C</button>
        <button id="Db" onclick="selectNote(1)">Db</button>
        <button id="D" onclick="selectNote(2)">D</button>
        <button id="Eb" onclick="selectNote(3)">Eb</button>
        <button id="E" onclick="selectNote(4)">E</button>
        <button id="F" onclick="selectNote(5)">F</button>
        <button id="Gb" onclick="selectNote(6)">Gb</button>
        <button id="G" onclick="selectNote(7)">G</button>
        <button id="Ab" onclick="selectNote(8)">Ab</button>
        <button id="A" onclick="selectNote(9)">A</button>
        <button id="Bb" onclick="selectNote(10)">Bb</button>
        <button id="B" onclick="selectNote(11)">B</button>
    </div>

    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="https://tonejs.github.io/build/Tone.js"></script>
    <script type="text/javascript">
        const notes = ["C", "Db", "D", "Eb", "E", "F", "Gb", "G", "Ab", "A", "Bb", "B"];
        var note = 60;

        const sampler = new Tone.Sampler({
            urls: {
                "A0": "A0.mp3",
                "C1": "C1.mp3",
                "D#1": "Ds1.mp3",
                "F#1": "Fs1.mp3",
                "A1": "A1.mp3",
                "C2": "C2.mp3",
                "D#2": "Ds2.mp3",
                "F#2": "Fs2.mp3",
                "A2": "A2.mp3",
                "C3": "C3.mp3",
                "D#3": "Ds3.mp3",
                "F#3": "Fs3.mp3",
                "A3": "A3.mp3",
                "C4": "C4.mp3",
                "D#4": "Ds4.mp3",
                "F#4": "Fs4.mp3",
                "A4": "A4.mp3",
                "C5": "C5.mp3",
                "D#5": "Ds5.mp3",
                "F#5": "Fs5.mp3",
                "A5": "A5.mp3",
                "C6": "C6.mp3",
                "D#6": "Ds6.mp3",
                "F#6": "Fs6.mp3",
                "A6": "A6.mp3",
                "C7": "C7.mp3",
                "D#7": "Ds7.mp3",
                "F#7": "Fs7.mp3",
                "A7": "A7.mp3",
                "C8": "C8.mp3"
            },
            release: 1,
            baseUrl: "https://tonejs.github.io/audio/salamander/",
        }).toDestination();

        function indexToNote(index) {
            return notes[index % 12] + parseInt(index / 12);
        }

        function playNote() {
            //note = parseInt(Math.random() * 12 + 48);
            note += parseInt(Math.random() * 24 - 12);
            Tone.loaded().then(() => {
                sampler.triggerAttackRelease(indexToNote(note), 1);
            });
            hideNote();
            deselectNotes();
        }

        function revealNote() {
            document.getElementById("noteText").innerHTML = indexToNote(note);
        }

        function hideNote() {
            document.getElementById("noteText").innerHTML = "";
        }

        function selectNote(index) {
            deselectNotes();
            document.getElementById(indexToNote(index % 12 + 12).slice(0, -1)).classList.add("selected");
            revealNote();
        }

        function deselectNotes() {
            for (let i = 0; i < 12; i++) {
                document.getElementById(indexToNote(i + 12).slice(0, -1)).classList.remove("selected");
            }
        }
    </script>
</body>

</html>
